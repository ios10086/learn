(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{373:function(s,a,t){"use strict";t.r(a);var n=t(45),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"自动化打包"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#自动化打包"}},[s._v("#")]),s._v(" 自动化打包")]),s._v(" "),t("h3",{attrs:{id:"打包脚本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#打包脚本"}},[s._v("#")]),s._v(" 打包脚本")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/sh")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用方法:")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# step1: 将该脚本放在工程的根目录下（跟.xcworkspace文件or .xcodeproj文件同目录）")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# step2: 根据情况修改下面的参数")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# step3: 打开终端，执行脚本。（输入sh ，然后将脚本文件拉到终端，会生成文件路径，然后enter就可）")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# =============项目自定义部分(自定义好下列参数后再执行该脚本)=================== #")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 是否编译工作空间 (例:若是用Cocopods管理的.xcworkspace项目,赋值true;用Xcode默认创建的.xcodeproj,赋值false)")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("is_workspace")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"true"')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# .xcworkspace的名字，如果is_workspace为true，则必须填。否则可不填")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("workspace_name")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hlEAM"')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# .xcodeproj的名字，如果is_workspace为false，则必须填。否则可不填")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("project_name")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定项目的scheme名称（也就是工程的target名称），必填")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("scheme_name")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hlEAM"')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定要打包编译的方式 : Release,Debug。一般用Release。必填")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("build_configuration")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Release"')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# method，打包的方式。方式分别为 development, ad-hoc, app-store, enterprise 。必填")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("method")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  下面两个参数只是在手动指定Pofile文件的时候用到，如果使用Xcode自动管理Profile,直接留空就好")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# (跟method对应的)mobileprovision文件名，需要先双击安装.mobileprovision文件.手动管理Profile时必填")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("mobileprovision_name")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 项目的bundleID，手动管理Profile时必填")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("bundle_identifier")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# APP名称")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("display_name")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# APP版本")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("app_version")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 平台上传包地址")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("plant_url")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 项目构建编号")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("build_number")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#框架版本")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("shell_branch")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#隐患版本")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("yh_branch")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#安全版本")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ses_other_branch")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#设备版本")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("eam_branch")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#作业版本")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("wts_branch")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("getopts")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'a:b:c:d:e:f:g:h:i:j:k:m:'")]),s._v(" OPT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$OPTARG")]),s._v('"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("case")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$OPT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v("\n        a"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("method")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$OPTARG")]),s._v('"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        b"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("bundle_identifier")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$OPTARG")]),s._v('"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        c"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("display_name")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$OPTARG")]),s._v('"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        d"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("app_version")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$OPTARG")]),s._v('"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ipa_name")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$OPTARG")]),s._v('"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        f"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("plant_url")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$OPTARG")]),s._v('"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        g"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("build_number")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$OPTARG")]),s._v('"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        h"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("shell_branch")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$OPTARG")]),s._v('"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        i"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("yh_branch")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$OPTARG")]),s._v('"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        j"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ses_other_branch")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$OPTARG")]),s._v('"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        k"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("eam_branch")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$OPTARG")]),s._v('"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        m"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("wts_branch")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$OPTARG")]),s._v('"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        ?"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Usage: '),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("basename")]),s._v(" $0"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v(' [options] filename"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("esac")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"啊啊啊啊啊"')]),s._v("\n\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"--------------------脚本配置参数检查--------------------"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"is_workspace='),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${is_workspace}")]),s._v(' "')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"workspace_name='),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${workspace_name}")]),s._v('"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"project_name='),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${project_name}")]),s._v('"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"scheme_name='),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${scheme_name}")]),s._v('"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"build_configuration='),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${build_configuration}")]),s._v('"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bundle_identifier='),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${bundle_identifier}")]),s._v('"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"method='),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${method}")]),s._v('"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mobileprovision_name='),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${mobileprovision_name}")]),s._v('"')]),s._v("\n\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# =======================脚本的一些固定参数定义(无特殊情况不用修改)====================== #")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 获取当前脚本所在目录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#script_dir="$( cd "$( dirname "$0"  )" && pwd  )"')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#xworkspace路径")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("script_dir")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${WORKSPACE}")]),s._v('/ISupPlant"')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 工程根目录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("project_dir")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$script_dir")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 时间")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DATE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'+%Y%m%d_%H%M%S'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定输出导出文件夹路径")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#export_path="$project_dir/Package/$scheme_name-$DATE"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("export_path")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${WORKSPACE}")]),s._v("/Package/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$scheme_name")]),s._v("-"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$DATE")]),s._v('"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定输出归档文件路径")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("export_archive_path")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$export_path")]),s._v("/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$scheme_name")]),s._v('.xcarchive"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定输出ipa文件夹路径")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("export_ipa_path")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$export_path")]),s._v('"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定输出ipa名称")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" ipa_name "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ipa_name")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${scheme_name}")]),s._v("_"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${DATE}")]),s._v('"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定导出ipa包需要用到的plist配置文件的路径")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("export_options_plist_path")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$project_dir")]),s._v('/ExportOptions.plist"')]),s._v("\n\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"--------------------脚本固定参数检查--------------------"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"project_dir='),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${project_dir}")]),s._v('"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"DATE='),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${DATE}")]),s._v('"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"export_path='),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${export_path}")]),s._v('"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"export_archive_path='),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${export_archive_path}")]),s._v('"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"export_ipa_path='),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${export_ipa_path}")]),s._v('"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"export_options_plist_path='),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${export_options_plist_path}")]),s._v('"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ipa_name='),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${ipa_name}")]),s._v('"')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# =======================增加业务模块版本信息====================== #")]),s._v("\n/usr/libexec/PlistBuddy -c "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Set :modelBranch:SHELL_BRANCH '),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${shell_branch}")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${project_dir}")]),s._v("/hlEAM/Info.plist\n/usr/libexec/PlistBuddy -c "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Set :modelBranch::YH_BRANCH '),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${yh_branch}")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${project_dir}")]),s._v("/hlEAM/Info.plist\n/usr/libexec/PlistBuddy -c "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Set :modelBranch::SES_OTHER_BRANCH '),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${ses_other_branch}")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${project_dir}")]),s._v("/hlEAM/Info.plist\n/usr/libexec/PlistBuddy -c "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Set :modelBranch::EAM_BRANCH '),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${eam_branch}")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${project_dir}")]),s._v("/hlEAM/Info.plist\n/usr/libexec/PlistBuddy -c "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Set :modelBranch::WTS_BRANCH '),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${wts_branch}")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${project_dir}")]),s._v("/hlEAM/Info.plist\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# =======================修改APP配置信息====================== #")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${project_dir}")]),s._v("/hlEAM.xcodeproj\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" -i "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"s/com.supcon.mobile.iSupPlant/'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${bundle_identifier}")]),s._v('/g"')]),s._v(" project.pbxproj\n/usr/libexec/PlistBuddy -c "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Set :CFBundleDisplayName '),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${display_name}")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${project_dir}")]),s._v("/hlEAM/Info.plist\n/usr/libexec/PlistBuddy -c "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Set :ipa_name '),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${ipa_name}")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${project_dir}")]),s._v("/hlEAM/about.plist\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${project_dir}")]),s._v("\nxcrun agvtool new-marketing-version "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${app_version}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# =======================自动打包部分(无特殊情况不用修改)====================== #")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"------------------------------------------------------"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"开始构建项目"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入项目工程目录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${project_dir}")]),s._v("\n\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定输出文件目录不存在则创建")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" -d "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$export_path")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$export_path")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -pv "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$export_path")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 判断编译的项目类型是workspace还是project")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$is_workspace")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 编译前清理工程")]),s._v("\nxcodebuild clean -workspace "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${workspace_name}")]),s._v(".xcworkspace "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-scheme "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${scheme_name}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-configuration "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${build_configuration}")]),s._v("\n\nxcodebuild archive -workspace "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${workspace_name}")]),s._v(".xcworkspace "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-scheme "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${scheme_name}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-configuration "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${build_configuration}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-archivePath "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${export_archive_path}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 编译前清理工程")]),s._v("\nxcodebuild clean -project "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${project_name}")]),s._v(".xcodeproj "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-scheme "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${scheme_name}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-configuration "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${build_configuration}")]),s._v("\n\nxcodebuild archive -project "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${project_name}")]),s._v(".xcodeproj "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-scheme "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${scheme_name}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-configuration "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${build_configuration}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-archivePath "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${export_archive_path}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  检查是否构建成功")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  xcarchive 实际是一个文件夹不是一个文件所以使用 -d 判断")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" -d "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$export_archive_path")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"项目构建成功 🚀 🚀 🚀"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"项目构建失败 😢 😢 😢"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"------------------------------------------------------"')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"开始导出ipa文件"')]),s._v("\n\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 先删除export_options_plist文件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" -f "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$export_options_plist_path")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#echo "${export_options_plist_path}文件存在，进行删除"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -f "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$export_options_plist_path")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 根据参数生成export_options_plist文件")]),s._v("\n/usr/libexec/PlistBuddy -c  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Add :method String '),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${method}")]),s._v('"')]),s._v("  "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$export_options_plist_path")]),s._v("\n/usr/libexec/PlistBuddy -c  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Add :provisioningProfiles:"')]),s._v("  "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$export_options_plist_path")]),s._v("\n/usr/libexec/PlistBuddy -c  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Add :provisioningProfiles:'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${bundle_identifier}")]),s._v(" String "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${mobileprovision_name}")]),s._v('"')]),s._v("  "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$export_options_plist_path")]),s._v("\n\n\nxcodebuild  -exportArchive "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-archivePath "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${export_archive_path}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-exportPath "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${export_ipa_path}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-exportOptionsPlist "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${export_options_plist_path}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-allowProvisioningUpdates\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 检查ipa文件是否存在")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" -f "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$export_ipa_path")]),s._v("/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$scheme_name")]),s._v('.ipa"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"exportArchive ipa包成功,准备进行重命名"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"exportArchive ipa包失败 😢 😢 😢"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改ipa文件名称")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${export_ipa_path}")]),s._v("/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${scheme_name}")]),s._v('.ipa"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${export_ipa_path}")]),s._v("/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${ipa_name}")]),s._v('.ipa"')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 检查文件是否存在")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" -f "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$export_ipa_path")]),s._v("/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ipa_name")]),s._v('.ipa"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"导出 '),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${ipa_name}")]),s._v('.ipa 包成功 🎉  🎉  🎉"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("open")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$export_path")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"导出 '),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${ipa_name}")]),s._v('.ipa 包失败 😢 😢 😢"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除export_options_plist文件（中间文件）")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" -f "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$export_options_plist_path")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#echo "${export_options_plist_path}文件存在，准备删除"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -f "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$export_options_plist_path")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输出打包总用时")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"使用AutoPackageScript打包总用时: '),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${"),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("SECONDS")]),s._v("}")]),s._v('s"')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("filePath")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$export_ipa_path")]),s._v("/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ipa_name")]),s._v('.ipa"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3333:'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$filePath")]),s._v('"')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 上传到蒲公英")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#json=$(curl -F "file=@$filePath" \\')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#-F "uKey=61860b1a4b5c365ee9c9bf880ef9dbf5" \\')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#-F "_api_key=08820f98036185e42ca4dfb53d426683" \\')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#https://www.pgyer.com/apiv1/app/upload)")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 蒲公英下载地址")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#url=$(echo $json | jq -r '.data|.appQRCodeURL')")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 生成json文件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#cd "${WORKSPACE}"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#echo "{')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#\\"url\\":\\"$url\\"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#}" > url.json')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 上传到平台")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("json")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -F "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"file=@'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$filePath")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-F "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"buildNumber='),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${build_number}")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n$plant_url/inter-api/mobile-platform/v1/appVersion/callback"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"4444:'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$json")]),s._v('"')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 平台下载地址")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("url")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" $json "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" jq -r "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.data|.downloadUrl'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("updateDescription")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" $json "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" jq -r "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.data|.updateDescription'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 生成json文件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${WORKSPACE}")]),s._v('"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{\n'),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v("url"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v(":"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$url")]),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v(",\n"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v("updateDescription"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v(":"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$updateDescription")]),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v('\n}"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" url.json\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\n\n")])])]),t("h3",{attrs:{id:"jenkins安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jenkins安装"}},[s._v("#")]),s._v(" jenkins安装")]),s._v(" "),t("p",[s._v("使用系统自带的homebrew来安装Jenkins,在终端中运行:")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ brew "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" Jenkins  \n")])])]),t("p",[s._v("启动Jenkins")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ jenkins\n")])])]),t("p",[s._v("浏览器输入http://localhost:8080打开jenkins。")]),s._v(" "),t("h3",{attrs:{id:"jenkins插件安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jenkins插件安装"}},[s._v("#")]),s._v(" jenkins插件安装")]),s._v(" "),t("p",[t("img",{attrs:{src:"/Users/mac/Desktop/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%89%93%E5%8C%85/%E6%8F%92%E4%BB%B61.png",alt:""}})]),s._v(" "),t("h5",{attrs:{id:"keychains-and-provisioning-profiles-management"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#keychains-and-provisioning-profiles-management"}},[s._v("#")]),s._v(" Keychains and Provisioning Profiles Management")]),s._v(" "),t("p",[s._v("管理本地的keychain和iOS证书的插件")]),s._v(" "),t("h5",{attrs:{id:"xcode-integration"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#xcode-integration"}},[s._v("#")]),s._v(" Xcode integration")]),s._v(" "),t("p",[s._v("用于xcode构建")]),s._v(" "),t("h5",{attrs:{id:"fir-plugin"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#fir-plugin"}},[s._v("#")]),s._v(" fir-plugin")]),s._v(" "),t("p",[s._v("将移动应用程序（Android，iOS等）发布到"),t("a",{attrs:{href:"http://fir.im/",target:"_blank",rel:"noopener noreferrer"}},[s._v("测试"),t("OutboundLink")],1),s._v("平台。")]),s._v(" "),t("p",[t("img",{attrs:{src:"/Users/mac/Desktop/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%89%93%E5%8C%85/%E6%8F%92%E4%BB%B62.png",alt:""}})]),s._v(" "),t("h3",{attrs:{id:"配置keychains-and-provisioning-profiles-management"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置keychains-and-provisioning-profiles-management"}},[s._v("#")]),s._v(" 配置Keychains and Provisioning Profiles Management")]),s._v(" "),t("p",[t("img",{attrs:{src:"/Users/mac/Desktop/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%89%93%E5%8C%85/%E9%85%8D%E7%BD%AE1.png",alt:"配置"}})]),s._v(" "),t("p",[s._v("前往文件路径~/Library/Keychains，将login.keychain-db复制出来删除-db，上传login.keychain。")]),s._v(" "),t("p",[s._v("下图红框固定为/Users/用户名/Library/MobileDevice/Provisioning Profiles，在此路径下选择Provisioning Profiles文件，然后upload。")]),s._v(" "),t("p",[t("img",{attrs:{src:"/Users/mac/Desktop/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%89%93%E5%8C%85/%E9%85%8D%E7%BD%AE2.png",alt:"配置页面"}})]),s._v(" "),t("h3",{attrs:{id:"构建任务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#构建任务"}},[s._v("#")]),s._v(" 构建任务")]),s._v(" "),t("h5",{attrs:{id:"创建一个自由风格的任务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建一个自由风格的任务"}},[s._v("#")]),s._v(" 创建一个自由风格的任务")]),s._v(" "),t("p",[t("img",{attrs:{src:"/Users/mac/Desktop/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%89%93%E5%8C%85/%E6%9E%84%E5%BB%BA%E4%BB%BB%E5%8A%A11.png",alt:"构建任务"}})]),s._v(" "),t("h5",{attrs:{id:"general"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#general"}},[s._v("#")]),s._v(" General")]),s._v(" "),t("p",[s._v("选择丢弃旧的构建，至于天数和保持的最大个数，按照自己的需求来。")]),s._v(" "),t("p",[t("img",{attrs:{src:"/Users/mac/Desktop/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%89%93%E5%8C%85/%E6%9E%84%E5%BB%BA%E4%BB%BB%E5%8A%A12.png",alt:"构建任务2"}})]),s._v(" "),t("h5",{attrs:{id:"源码管理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#源码管理"}},[s._v("#")]),s._v(" 源码管理")]),s._v(" "),t("p",[s._v("在Repository URL里面添加git地址，使用ssh填上密钥。")]),s._v(" "),t("p",[t("img",{attrs:{src:"/Users/mac/Desktop/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%89%93%E5%8C%85/%E6%9E%84%E5%BB%BA%E4%BB%BB%E5%8A%A13.png",alt:"构建任务3"}})]),s._v(" "),t("h5",{attrs:{id:"构建触发器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#构建触发器"}},[s._v("#")]),s._v(" 构建触发器")]),s._v(" "),t("p",[t("img",{attrs:{src:"/Users/mac/Desktop/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%89%93%E5%8C%85/%E6%9E%84%E5%BB%BA%E4%BB%BB%E5%8A%A14.png",alt:"构建任务4"}})]),s._v(" "),t("h5",{attrs:{id:"构建环境"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#构建环境"}},[s._v("#")]),s._v(" 构建环境")]),s._v(" "),t("p",[t("img",{attrs:{src:"/Users/mac/Desktop/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%89%93%E5%8C%85/%E6%9E%84%E5%BB%BA%E4%BB%BB%E5%8A%A15.png",alt:"构建任务5"}})]),s._v(" "),t("h5",{attrs:{id:"构建"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#构建"}},[s._v("#")]),s._v(" 构建")]),s._v(" "),t("p",[s._v("导入脚本。")]),s._v(" "),t("p",[t("img",{attrs:{src:"/Users/mac/Desktop/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%89%93%E5%8C%85/%E6%9E%84%E5%BB%BA%E4%BB%BB%E5%8A%A16.png",alt:"构建任务6"}})]),s._v(" "),t("h5",{attrs:{id:"构建后操作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#构建后操作"}},[s._v("#")]),s._v(" 构建后操作")]),s._v(" "),t("p",[s._v("填写fir token、build Notes，构建完成自动上传至fir。")]),s._v(" "),t("p",[t("img",{attrs:{src:"/Users/mac/Desktop/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%89%93%E5%8C%85/%E6%9E%84%E5%BB%BA%E4%BB%BB%E5%8A%A17.png",alt:"构建任务7"}})])])}),[],!1,null,null,null);a.default=e.exports}}]);